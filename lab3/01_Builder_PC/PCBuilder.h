#pragma once
#include <iostream>
#include <string>
#include <vector>
#include <memory>
#include <sstream>

// === 1. Продукт (Product) ===
class Компьютер {
private:
    std::vector<std::string> части;
public:
    void добавитьЧасть(const std::string& часть) {
        части.push_back(часть);
    }
    std::string показатьКонфигурацию() const {
        std::stringstream ss;
        ss << "Конфигурация Компьютера:\n";
        for (const auto& part : части) {
            ss << " - " << part << "\n";
        }
        return ss.str();
    }
};

// === 2. Абстрактный Строитель (Builder) ===
class АбстрактныйСтроительПК {
public:
    virtual ~АбстрактныйСтроительПК() = default;
    virtual void сбросить() = 0; // Сброс текущего продукта (Компьютер)
    
    // Пошаговые методы сборки
    virtual void установитьПроцессор() const = 0;
    virtual void установитьПамять() const = 0;
    virtual void установитьВидеокарту() const = 0;
    
    // Метод получения конечного продукта
    virtual std::unique_ptr<Компьютер> получитьРезультат() = 0;
};

// === 3. Конкретные Строители (Concrete Builders) ===

class ИгровойСтроитель : public АбстрактныйСтроительПК {
private:
    std::unique_ptr<Компьютер> продукт;
public:
    ИгровойСтроитель() { this->сбросить(); }
    void сбросить() override {
        продукт = std::make_unique<Компьютер>();
    }
    
    void установитьПроцессор() const override {
        продукт->добавитьЧасть("Мощный CPU (i9/Ryzen 9)");
    }
    void установитьПамять() const override {
        продукт->добавитьЧасть("32GB RAM (быстрая)");
    }
    void установитьВидеокарту() const override {
        продукт->добавитьЧасть("NVIDIA RTX 4080 (игровая)");
    }
    std::unique_ptr<Компьютер> получитьРезультат() override {
        // Возвращаем готовый продукт и сбрасываем состояние
        return std::move(продукт);
    }
};

class ОфисныйСтроитель : public АбстрактныйСтроительПК {
private:
    std::unique_ptr<Компьютер> продукт;
public:
    ОфисныйСтроитель() { this->сбросить(); }
    void сбросить() override {
        продукт = std::make_unique<Компьютер>();
    }
    void установитьПроцессор() const override {
        продукт->добавитьЧасть("Бюджетный CPU (i3/Ryzen 3)");
    }
    void установитьПамять() const override {
        продукт->добавитьЧасть("8GB RAM (стандартная)");
    }
    void установитьВидеокарту() const override {
        продукт->добавитьЧасть("Встроенная графика");
    }
    std::unique_ptr<Компьютер> получитьРезультат() override {
        return std::move(продукт);
    }
};

// === 4. Директор (Director) ===
// Управляет процессом сборки
class Сборщик {
private:
    АбстрактныйСтроительПК* строитель;
public:
    void установитьСтроителя(АбстрактныйСтроительПК* б) {
        строитель = б;
    }
    // Метод для стандартной сборки
    void собратьСтандартныйПК() {
        строитель->сбросить();
        строитель->установитьПроцессор();
        строитель->установитьПамять();
        // Стандартный ПК не требует мощной видеокарты
    }
    // Метод для полной сборки (Игровой)
    void собратьПолныйПК() {
        строитель->сбросить();
        строитель->установитьПроцессор();
        строитель->установитьПамять();
        строитель->установитьВидеокарту();
    }
};